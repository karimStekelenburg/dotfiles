var ls=Object.create;var tr=Object.defineProperty;var fs=Object.getOwnPropertyDescriptor;var cs=Object.getOwnPropertyNames;var ds=Object.getPrototypeOf,hs=Object.prototype.hasOwnProperty;var $o=r=>tr(r,"__esModule",{value:!0});var bt=(r,n)=>()=>(n||r((n={exports:{}}).exports,n),n.exports),ms=(r,n)=>{for(var a in n)tr(r,a,{get:n[a],enumerable:!0})},Mo=(r,n,a,s)=>{if(n&&typeof n=="object"||typeof n=="function")for(let l of cs(n))!hs.call(r,l)&&(a||l!=="default")&&tr(r,l,{get:()=>n[l],enumerable:!(s=fs(n,l))||s.enumerable});return r},ne=(r,n)=>Mo($o(tr(r!=null?ls(ds(r)):{},"default",!n&&r&&r.__esModule?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r),ps=(r=>(n,a)=>r&&r.get(n)||(a=Mo($o({}),n,1),r&&r.set(n,a),a))(typeof WeakMap!="undefined"?new WeakMap:0);var No=(r,n,a)=>{if(!n.has(r))throw TypeError("Cannot "+a)};var Ie=(r,n,a)=>(No(r,n,"read from private field"),a?a.call(r):n.get(r)),rr=(r,n,a)=>{if(n.has(r))throw TypeError("Cannot add the same private member more than once");n instanceof WeakSet?n.add(r):n.set(r,a)},Qe=(r,n,a,s)=>(No(r,n,"write to private field"),s?s.call(r,a):n.set(r,a),a);var ta=bt((gt,Ge)=>{var bs=9007199254740991,ys="[object Arguments]",gs="[object Function]",_s="[object GeneratorFunction]",Jr="[object Map]",Ss="[object Object]",xo="[object Promise]",Zr="[object Set]",Uo="[object WeakMap]",Ho="[object DataView]",ws=/[\\^$.*+?()[\]{}|]/g,Rs=/^\[object .+?Constructor\]$/,Cs=typeof global=="object"&&global&&global.Object===Object&&global,Ts=typeof self=="object"&&self&&self.Object===Object&&self,We=Cs||Ts||Function("return this")(),Vo=typeof gt=="object"&&gt&&!gt.nodeType&&gt,Qo=Vo&&typeof Ge=="object"&&Ge&&!Ge.nodeType&&Ge,Ps=Qo&&Qo.exports===Vo;function Es(r,n){return r==null?void 0:r[n]}function vs(r){var n=!1;if(r!=null&&typeof r.toString!="function")try{n=!!(r+"")}catch{}return n}function As(r,n){return function(a){return r(n(a))}}var ks=Function.prototype,nr=Object.prototype,Xr=We["__core-js_shared__"],Go=function(){var r=/[^.]+$/.exec(Xr&&Xr.keys&&Xr.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),Yo=ks.toString,en=nr.hasOwnProperty,or=nr.toString,Bs=RegExp("^"+Yo.call(en).replace(ws,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ko=Ps?We.Buffer:void 0,Jo=nr.propertyIsEnumerable,Is=Ko?Ko.isBuffer:void 0,Ws=As(Object.keys,Object),tn=yt(We,"DataView"),rn=yt(We,"Map"),nn=yt(We,"Promise"),on=yt(We,"Set"),an=yt(We,"WeakMap"),Os=!Jo.call({valueOf:1},"valueOf"),qs=qe(tn),js=qe(rn),zs=qe(nn),Fs=qe(on),Ls=qe(an);function Ds(r){return or.call(r)}function $s(r){if(!ea(r)||Ms(r))return!1;var n=Xo(r)||vs(r)?Bs:Rs;return n.test(qe(r))}function yt(r,n){var a=Es(r,n);return $s(a)?a:void 0}var Oe=Ds;(tn&&Oe(new tn(new ArrayBuffer(1)))!=Ho||rn&&Oe(new rn)!=Jr||nn&&Oe(nn.resolve())!=xo||on&&Oe(new on)!=Zr||an&&Oe(new an)!=Uo)&&(Oe=function(r){var n=or.call(r),a=n==Ss?r.constructor:void 0,s=a?qe(a):void 0;if(s)switch(s){case qs:return Ho;case js:return Jr;case zs:return xo;case Fs:return Zr;case Ls:return Uo}return n});function Ms(r){return!!Go&&Go in r}function Ns(r){var n=r&&r.constructor,a=typeof n=="function"&&n.prototype||nr;return r===a}function qe(r){if(r!=null){try{return Yo.call(r)}catch{}try{return r+""}catch{}}return""}function xs(r){return Hs(r)&&en.call(r,"callee")&&(!Jo.call(r,"callee")||or.call(r)==ys)}var Us=Array.isArray;function Zo(r){return r!=null&&Gs(r.length)&&!Xo(r)}function Hs(r){return Ys(r)&&Zo(r)}var Vs=Is||Ks;function Qs(r){if(Zo(r)&&(Us(r)||typeof r=="string"||typeof r.splice=="function"||Vs(r)||xs(r)))return!r.length;var n=Oe(r);if(n==Jr||n==Zr)return!r.size;if(Os||Ns(r))return!Ws(r).length;for(var a in r)if(en.call(r,a))return!1;return!0}function Xo(r){var n=ea(r)?or.call(r):"";return n==gs||n==_s}function Gs(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=bs}function ea(r){var n=typeof r;return!!r&&(n=="object"||n=="function")}function Ys(r){return!!r&&typeof r=="object"}function Ks(){return!1}Ge.exports=Qs});var ua=bt((ul,sa)=>{var Js=200,sn="__lodash_hash_undefined__",Zs=1/0,Xs="[object Function]",eu="[object GeneratorFunction]",tu=/[\\^$.*+?()[\]{}|]/g,ru=/^\[object .+?Constructor\]$/,nu=typeof global=="object"&&global&&global.Object===Object&&global,ou=typeof self=="object"&&self&&self.Object===Object&&self,un=nu||ou||Function("return this")();function au(r,n){var a=r?r.length:0;return!!a&&uu(r,n,0)>-1}function iu(r,n,a){for(var s=-1,l=r?r.length:0;++s<l;)if(a(n,r[s]))return!0;return!1}function su(r,n,a,s){for(var l=r.length,d=a+(s?1:-1);s?d--:++d<l;)if(n(r[d],d,r))return d;return-1}function uu(r,n,a){if(n!==n)return su(r,lu,a);for(var s=a-1,l=r.length;++s<l;)if(r[s]===n)return s;return-1}function lu(r){return r!==r}function fu(r,n){return r.has(n)}function cu(r,n){return r==null?void 0:r[n]}function du(r){var n=!1;if(r!=null&&typeof r.toString!="function")try{n=!!(r+"")}catch{}return n}function ra(r){var n=-1,a=Array(r.size);return r.forEach(function(s){a[++n]=s}),a}var hu=Array.prototype,mu=Function.prototype,na=Object.prototype,ln=un["__core-js_shared__"],oa=function(){var r=/[^.]+$/.exec(ln&&ln.keys&&ln.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),aa=mu.toString,fn=na.hasOwnProperty,pu=na.toString,bu=RegExp("^"+aa.call(fn).replace(tu,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),yu=hu.splice,gu=dn(un,"Map"),cn=dn(un,"Set"),_t=dn(Object,"create");function je(r){var n=-1,a=r?r.length:0;for(this.clear();++n<a;){var s=r[n];this.set(s[0],s[1])}}function _u(){this.__data__=_t?_t(null):{}}function Su(r){return this.has(r)&&delete this.__data__[r]}function wu(r){var n=this.__data__;if(_t){var a=n[r];return a===sn?void 0:a}return fn.call(n,r)?n[r]:void 0}function Ru(r){var n=this.__data__;return _t?n[r]!==void 0:fn.call(n,r)}function Cu(r,n){var a=this.__data__;return a[r]=_t&&n===void 0?sn:n,this}je.prototype.clear=_u;je.prototype.delete=Su;je.prototype.get=wu;je.prototype.has=Ru;je.prototype.set=Cu;function Ye(r){var n=-1,a=r?r.length:0;for(this.clear();++n<a;){var s=r[n];this.set(s[0],s[1])}}function Tu(){this.__data__=[]}function Pu(r){var n=this.__data__,a=ir(n,r);if(a<0)return!1;var s=n.length-1;return a==s?n.pop():yu.call(n,a,1),!0}function Eu(r){var n=this.__data__,a=ir(n,r);return a<0?void 0:n[a][1]}function vu(r){return ir(this.__data__,r)>-1}function Au(r,n){var a=this.__data__,s=ir(a,r);return s<0?a.push([r,n]):a[s][1]=n,this}Ye.prototype.clear=Tu;Ye.prototype.delete=Pu;Ye.prototype.get=Eu;Ye.prototype.has=vu;Ye.prototype.set=Au;function Ke(r){var n=-1,a=r?r.length:0;for(this.clear();++n<a;){var s=r[n];this.set(s[0],s[1])}}function ku(){this.__data__={hash:new je,map:new(gu||Ye),string:new je}}function Bu(r){return sr(this,r).delete(r)}function Iu(r){return sr(this,r).get(r)}function Wu(r){return sr(this,r).has(r)}function Ou(r,n){return sr(this,r).set(r,n),this}Ke.prototype.clear=ku;Ke.prototype.delete=Bu;Ke.prototype.get=Iu;Ke.prototype.has=Wu;Ke.prototype.set=Ou;function ar(r){var n=-1,a=r?r.length:0;for(this.__data__=new Ke;++n<a;)this.add(r[n])}function qu(r){return this.__data__.set(r,sn),this}function ju(r){return this.__data__.has(r)}ar.prototype.add=ar.prototype.push=qu;ar.prototype.has=ju;function ir(r,n){for(var a=r.length;a--;)if(xu(r[a][0],n))return a;return-1}function zu(r){if(!ia(r)||$u(r))return!1;var n=Uu(r)||du(r)?bu:ru;return n.test(Mu(r))}function Fu(r,n,a){var s=-1,l=au,d=r.length,p=!0,m=[],g=m;if(a)p=!1,l=iu;else if(d>=Js){var S=n?null:Lu(r);if(S)return ra(S);p=!1,l=fu,g=new ar}else g=n?[]:m;e:for(;++s<d;){var P=r[s],C=n?n(P):P;if(P=a||P!==0?P:0,p&&C===C){for(var w=g.length;w--;)if(g[w]===C)continue e;n&&g.push(C),m.push(P)}else l(g,C,a)||(g!==m&&g.push(C),m.push(P))}return m}var Lu=cn&&1/ra(new cn([,-0]))[1]==Zs?function(r){return new cn(r)}:Hu;function sr(r,n){var a=r.__data__;return Du(n)?a[typeof n=="string"?"string":"hash"]:a.map}function dn(r,n){var a=cu(r,n);return zu(a)?a:void 0}function Du(r){var n=typeof r;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?r!=="__proto__":r===null}function $u(r){return!!oa&&oa in r}function Mu(r){if(r!=null){try{return aa.call(r)}catch{}try{return r+""}catch{}}return""}function Nu(r,n){return r&&r.length?Fu(r,void 0,n):[]}function xu(r,n){return r===n||r!==r&&n!==n}function Uu(r){var n=ia(r)?pu.call(r):"";return n==Xs||n==eu}function ia(r){var n=typeof r;return!!r&&(n=="object"||n=="function")}function Hu(){}sa.exports=Nu});var fa=bt((ll,la)=>{"use strict";function Vu(r){if(!/^data:/i.test(r))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');r=r.replace(/\r?\n/g,"");let n=r.indexOf(",");if(n===-1||n<=4)throw new TypeError("malformed data: URI");let a=r.substring(5,n).split(";"),s="",l=!1,d=a[0]||"text/plain",p=d;for(let P=1;P<a.length;P++)a[P]==="base64"?l=!0:(p+=`;${a[P]}`,a[P].indexOf("charset=")===0&&(s=a[P].substring(8)));!a[0]&&!s.length&&(p+=";charset=US-ASCII",s="US-ASCII");let m=l?"base64":"ascii",g=unescape(r.substring(n+1)),S=Buffer.from(g,m);return S.type=d,S.typeFull=p,S.charset=s,S}la.exports=Vu});var da=bt((ur,ca)=>{(function(r,n){typeof ur=="object"&&typeof ca!="undefined"?n(ur):typeof define=="function"&&define.amd?define(["exports"],n):(r=typeof globalThis!="undefined"?globalThis:r||self,n(r.WebStreamsPolyfill={}))})(ur,function(r){"use strict";let n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol:e=>`Symbol(${e})`;function a(){}function s(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global}let l=s();function d(e){return typeof e=="object"&&e!==null||typeof e=="function"}let p=a,m=Promise,g=Promise.prototype.then,S=Promise.resolve.bind(m),P=Promise.reject.bind(m);function C(e){return new m(e)}function w(e){return S(e)}function h(e){return P(e)}function A(e,t,o){return g.call(e,t,o)}function v(e,t,o){A(A(e,t,o),void 0,p)}function N(e,t){v(e,t)}function ee(e,t){v(e,void 0,t)}function ae(e,t,o){return A(e,t,o)}function ie(e){A(e,void 0,p)}let V=(()=>{let e=l&&l.queueMicrotask;if(typeof e=="function")return e;let t=w(void 0);return o=>A(t,o)})();function se(e,t,o){if(typeof e!="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(e,t,o)}function Te(e,t,o){try{return w(se(e,t,o))}catch(i){return h(i)}}let Cn=16384;class Q{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(t){let o=this._back,i=o;o._elements.length===Cn-1&&(i={_elements:[],_next:void 0}),o._elements.push(t),i!==o&&(this._back=i,o._next=i),++this._size}shift(){let t=this._front,o=t,i=this._cursor,u=i+1,f=t._elements,c=f[i];return u===Cn&&(o=t._next,u=0),--this._size,this._cursor=u,t!==o&&(this._front=o),f[i]=void 0,c}forEach(t){let o=this._cursor,i=this._front,u=i._elements;for(;(o!==u.length||i._next!==void 0)&&!(o===u.length&&(i=i._next,u=i._elements,o=0,u.length===0));)t(u[o]),++o}peek(){let t=this._front,o=this._cursor;return t._elements[o]}}function Tn(e,t){e._ownerReadableStream=t,t._reader=e,t._state==="readable"?_r(e):t._state==="closed"?La(e):Pn(e,t._storedError)}function gr(e,t){let o=e._ownerReadableStream;return K(o,t)}function ue(e){e._ownerReadableStream._state==="readable"?Sr(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):Da(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),e._ownerReadableStream._reader=void 0,e._ownerReadableStream=void 0}function De(e){return new TypeError("Cannot "+e+" a stream using a released reader")}function _r(e){e._closedPromise=C((t,o)=>{e._closedPromise_resolve=t,e._closedPromise_reject=o})}function Pn(e,t){_r(e),Sr(e,t)}function La(e){_r(e),En(e)}function Sr(e,t){e._closedPromise_reject!==void 0&&(ie(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}function Da(e,t){Pn(e,t)}function En(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}let vn=n("[[AbortSteps]]"),An=n("[[ErrorSteps]]"),wr=n("[[CancelSteps]]"),Rr=n("[[PullSteps]]"),kn=Number.isFinite||function(e){return typeof e=="number"&&isFinite(e)},$a=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};function Ma(e){return typeof e=="object"||typeof e=="function"}function le(e,t){if(e!==void 0&&!Ma(e))throw new TypeError(`${t} is not an object.`)}function G(e,t){if(typeof e!="function")throw new TypeError(`${t} is not a function.`)}function Na(e){return typeof e=="object"&&e!==null||typeof e=="function"}function Bn(e,t){if(!Na(e))throw new TypeError(`${t} is not an object.`)}function fe(e,t,o){if(e===void 0)throw new TypeError(`Parameter ${t} is required in '${o}'.`)}function Cr(e,t,o){if(e===void 0)throw new TypeError(`${t} is required in '${o}'.`)}function Tr(e){return Number(e)}function In(e){return e===0?0:e}function xa(e){return In($a(e))}function Wn(e,t){let o=0,i=Number.MAX_SAFE_INTEGER,u=Number(e);if(u=In(u),!kn(u))throw new TypeError(`${t} is not a finite number`);if(u=xa(u),u<o||u>i)throw new TypeError(`${t} is outside the accepted range of ${o} to ${i}, inclusive`);return!kn(u)||u===0?0:u}function Pr(e,t){if(!ye(e))throw new TypeError(`${t} is not a ReadableStream.`)}function $e(e){return new et(e)}function On(e,t){e._reader._readRequests.push(t)}function Er(e,t,o){let u=e._reader._readRequests.shift();o?u._closeSteps():u._chunkSteps(t)}function Tt(e){return e._reader._readRequests.length}function qn(e){let t=e._reader;return!(t===void 0||!he(t))}class et{constructor(t){if(fe(t,1,"ReadableStreamDefaultReader"),Pr(t,"First parameter"),ge(t))throw new TypeError("This stream has already been locked for exclusive reading by another reader");Tn(this,t),this._readRequests=new Q}get closed(){return he(this)?this._closedPromise:h(Pt("closed"))}cancel(t=void 0){return he(this)?this._ownerReadableStream===void 0?h(De("cancel")):gr(this,t):h(Pt("cancel"))}read(){if(!he(this))return h(Pt("read"));if(this._ownerReadableStream===void 0)return h(De("read from"));let t,o,i=C((f,c)=>{t=f,o=c});return tt(this,{_chunkSteps:f=>t({value:f,done:!1}),_closeSteps:()=>t({value:void 0,done:!0}),_errorSteps:f=>o(f)}),i}releaseLock(){if(!he(this))throw Pt("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");ue(this)}}}Object.defineProperties(et.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(et.prototype,n.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});function he(e){return!d(e)||!Object.prototype.hasOwnProperty.call(e,"_readRequests")?!1:e instanceof et}function tt(e,t){let o=e._ownerReadableStream;o._disturbed=!0,o._state==="closed"?t._closeSteps():o._state==="errored"?t._errorSteps(o._storedError):o._readableStreamController[Rr](t)}function Pt(e){return new TypeError(`ReadableStreamDefaultReader.prototype.${e} can only be used on a ReadableStreamDefaultReader`)}let jn=Object.getPrototypeOf(Object.getPrototypeOf(async function*(){}).prototype);class zn{constructor(t,o){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=t,this._preventCancel=o}next(){let t=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?ae(this._ongoingPromise,t,t):t(),this._ongoingPromise}return(t){let o=()=>this._returnSteps(t);return this._ongoingPromise?ae(this._ongoingPromise,o,o):o()}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});let t=this._reader;if(t._ownerReadableStream===void 0)return h(De("iterate"));let o,i,u=C((c,b)=>{o=c,i=b});return tt(t,{_chunkSteps:c=>{this._ongoingPromise=void 0,V(()=>o({value:c,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,ue(t),o({value:void 0,done:!0})},_errorSteps:c=>{this._ongoingPromise=void 0,this._isFinished=!0,ue(t),i(c)}}),u}_returnSteps(t){if(this._isFinished)return Promise.resolve({value:t,done:!0});this._isFinished=!0;let o=this._reader;if(o._ownerReadableStream===void 0)return h(De("finish iterating"));if(!this._preventCancel){let i=gr(o,t);return ue(o),ae(i,()=>({value:t,done:!0}))}return ue(o),w({value:t,done:!0})}}let Fn={next(){return Ln(this)?this._asyncIteratorImpl.next():h(Dn("next"))},return(e){return Ln(this)?this._asyncIteratorImpl.return(e):h(Dn("return"))}};jn!==void 0&&Object.setPrototypeOf(Fn,jn);function Ua(e,t){let o=$e(e),i=new zn(o,t),u=Object.create(Fn);return u._asyncIteratorImpl=i,u}function Ln(e){if(!d(e)||!Object.prototype.hasOwnProperty.call(e,"_asyncIteratorImpl"))return!1;try{return e._asyncIteratorImpl instanceof zn}catch{return!1}}function Dn(e){return new TypeError(`ReadableStreamAsyncIterator.${e} can only be used on a ReadableSteamAsyncIterator`)}let $n=Number.isNaN||function(e){return e!==e};function rt(e){return e.slice()}function Mn(e,t,o,i,u){new Uint8Array(e).set(new Uint8Array(o,i,u),t)}function il(e){return e}function Et(e){return!1}function Nn(e,t,o){if(e.slice)return e.slice(t,o);let i=o-t,u=new ArrayBuffer(i);return Mn(u,0,e,t,i),u}function Ha(e){return!(typeof e!="number"||$n(e)||e<0)}function xn(e){let t=Nn(e.buffer,e.byteOffset,e.byteOffset+e.byteLength);return new Uint8Array(t)}function vr(e){let t=e._queue.shift();return e._queueTotalSize-=t.size,e._queueTotalSize<0&&(e._queueTotalSize=0),t.value}function Ar(e,t,o){if(!Ha(o)||o===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");e._queue.push({value:t,size:o}),e._queueTotalSize+=o}function Va(e){return e._queue.peek().value}function me(e){e._queue=new Q,e._queueTotalSize=0}class nt{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!kr(this))throw qr("view");return this._view}respond(t){if(!kr(this))throw qr("respond");if(fe(t,1,"respond"),t=Wn(t,"First parameter"),this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");Et(this._view.buffer),Bt(this._associatedReadableByteStreamController,t)}respondWithNewView(t){if(!kr(this))throw qr("respondWithNewView");if(fe(t,1,"respondWithNewView"),!ArrayBuffer.isView(t))throw new TypeError("You can only respond with array buffer views");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");Et(t.buffer),It(this._associatedReadableByteStreamController,t)}}Object.defineProperties(nt.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(nt.prototype,n.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class Me{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!Pe(this))throw at("byobRequest");return Or(this)}get desiredSize(){if(!Pe(this))throw at("desiredSize");return Jn(this)}close(){if(!Pe(this))throw at("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");let t=this._controlledReadableByteStream._state;if(t!=="readable")throw new TypeError(`The stream (in ${t} state) is not in the readable state and cannot be closed`);ot(this)}enqueue(t){if(!Pe(this))throw at("enqueue");if(fe(t,1,"enqueue"),!ArrayBuffer.isView(t))throw new TypeError("chunk must be an array buffer view");if(t.byteLength===0)throw new TypeError("chunk must have non-zero byteLength");if(t.buffer.byteLength===0)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");let o=this._controlledReadableByteStream._state;if(o!=="readable")throw new TypeError(`The stream (in ${o} state) is not in the readable state and cannot be enqueued to`);kt(this,t)}error(t=void 0){if(!Pe(this))throw at("error");Y(this,t)}[wr](t){Un(this),me(this);let o=this._cancelAlgorithm(t);return At(this),o}[Rr](t){let o=this._controlledReadableByteStream;if(this._queueTotalSize>0){let u=this._queue.shift();this._queueTotalSize-=u.byteLength,Gn(this);let f=new Uint8Array(u.buffer,u.byteOffset,u.byteLength);t._chunkSteps(f);return}let i=this._autoAllocateChunkSize;if(i!==void 0){let u;try{u=new ArrayBuffer(i)}catch(c){t._errorSteps(c);return}let f={buffer:u,bufferByteLength:i,byteOffset:0,byteLength:i,bytesFilled:0,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(f)}On(o,t),Ee(this)}}Object.defineProperties(Me.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(Me.prototype,n.toStringTag,{value:"ReadableByteStreamController",configurable:!0});function Pe(e){return!d(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableByteStream")?!1:e instanceof Me}function kr(e){return!d(e)||!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController")?!1:e instanceof nt}function Ee(e){if(!Ka(e))return;if(e._pulling){e._pullAgain=!0;return}e._pulling=!0;let o=e._pullAlgorithm();v(o,()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,Ee(e))},i=>{Y(e,i)})}function Un(e){Ir(e),e._pendingPullIntos=new Q}function Br(e,t){let o=!1;e._state==="closed"&&(o=!0);let i=Hn(t);t.readerType==="default"?Er(e,i,o):Xa(e,i,o)}function Hn(e){let t=e.bytesFilled,o=e.elementSize;return new e.viewConstructor(e.buffer,e.byteOffset,t/o)}function vt(e,t,o,i){e._queue.push({buffer:t,byteOffset:o,byteLength:i}),e._queueTotalSize+=i}function Vn(e,t){let o=t.elementSize,i=t.bytesFilled-t.bytesFilled%o,u=Math.min(e._queueTotalSize,t.byteLength-t.bytesFilled),f=t.bytesFilled+u,c=f-f%o,b=u,_=!1;c>i&&(b=c-t.bytesFilled,_=!0);let T=e._queue;for(;b>0;){let I=T.peek(),k=Math.min(b,I.byteLength),O=t.byteOffset+t.bytesFilled;Mn(t.buffer,O,I.buffer,I.byteOffset,k),I.byteLength===k?T.shift():(I.byteOffset+=k,I.byteLength-=k),e._queueTotalSize-=k,Qn(e,k,t),b-=k}return _}function Qn(e,t,o){o.bytesFilled+=t}function Gn(e){e._queueTotalSize===0&&e._closeRequested?(At(e),ht(e._controlledReadableByteStream)):Ee(e)}function Ir(e){e._byobRequest!==null&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=null,e._byobRequest=null)}function Yn(e){for(;e._pendingPullIntos.length>0;){if(e._queueTotalSize===0)return;let t=e._pendingPullIntos.peek();Vn(e,t)&&(Wr(e),Br(e._controlledReadableByteStream,t))}}function Qa(e,t,o){let i=e._controlledReadableByteStream,u=1;t.constructor!==DataView&&(u=t.constructor.BYTES_PER_ELEMENT);let f=t.constructor,c=t.buffer,b={buffer:c,bufferByteLength:c.byteLength,byteOffset:t.byteOffset,byteLength:t.byteLength,bytesFilled:0,elementSize:u,viewConstructor:f,readerType:"byob"};if(e._pendingPullIntos.length>0){e._pendingPullIntos.push(b),eo(i,o);return}if(i._state==="closed"){let _=new f(b.buffer,b.byteOffset,0);o._closeSteps(_);return}if(e._queueTotalSize>0){if(Vn(e,b)){let _=Hn(b);Gn(e),o._chunkSteps(_);return}if(e._closeRequested){let _=new TypeError("Insufficient bytes to fill elements in the given buffer");Y(e,_),o._errorSteps(_);return}}e._pendingPullIntos.push(b),eo(i,o),Ee(e)}function Ga(e,t){let o=e._controlledReadableByteStream;if(jr(o))for(;to(o)>0;){let i=Wr(e);Br(o,i)}}function Ya(e,t,o){if(Qn(e,t,o),o.bytesFilled<o.elementSize)return;Wr(e);let i=o.bytesFilled%o.elementSize;if(i>0){let u=o.byteOffset+o.bytesFilled,f=Nn(o.buffer,u-i,u);vt(e,f,0,f.byteLength)}o.bytesFilled-=i,Br(e._controlledReadableByteStream,o),Yn(e)}function Kn(e,t){let o=e._pendingPullIntos.peek();Ir(e),e._controlledReadableByteStream._state==="closed"?Ga(e):Ya(e,t,o),Ee(e)}function Wr(e){return e._pendingPullIntos.shift()}function Ka(e){let t=e._controlledReadableByteStream;return t._state!=="readable"||e._closeRequested||!e._started?!1:!!(qn(t)&&Tt(t)>0||jr(t)&&to(t)>0||Jn(e)>0)}function At(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0}function ot(e){let t=e._controlledReadableByteStream;if(!(e._closeRequested||t._state!=="readable")){if(e._queueTotalSize>0){e._closeRequested=!0;return}if(e._pendingPullIntos.length>0&&e._pendingPullIntos.peek().bytesFilled>0){let i=new TypeError("Insufficient bytes to fill elements in the given buffer");throw Y(e,i),i}At(e),ht(t)}}function kt(e,t){let o=e._controlledReadableByteStream;if(e._closeRequested||o._state!=="readable")return;let i=t.buffer,u=t.byteOffset,f=t.byteLength,c=i;if(e._pendingPullIntos.length>0){let b=e._pendingPullIntos.peek();Et(b.buffer),b.buffer=b.buffer}if(Ir(e),qn(o))if(Tt(o)===0)vt(e,c,u,f);else{let b=new Uint8Array(c,u,f);Er(o,b,!1)}else jr(o)?(vt(e,c,u,f),Yn(e)):vt(e,c,u,f);Ee(e)}function Y(e,t){let o=e._controlledReadableByteStream;o._state==="readable"&&(Un(e),me(e),At(e),Eo(o,t))}function Or(e){if(e._byobRequest===null&&e._pendingPullIntos.length>0){let t=e._pendingPullIntos.peek(),o=new Uint8Array(t.buffer,t.byteOffset+t.bytesFilled,t.byteLength-t.bytesFilled),i=Object.create(nt.prototype);Za(i,e,o),e._byobRequest=i}return e._byobRequest}function Jn(e){let t=e._controlledReadableByteStream._state;return t==="errored"?null:t==="closed"?0:e._strategyHWM-e._queueTotalSize}function Bt(e,t){let o=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(t!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(t===0)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(o.bytesFilled+t>o.byteLength)throw new RangeError("bytesWritten out of range")}o.buffer=o.buffer,Kn(e,t)}function It(e,t){let o=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(t.byteLength!==0)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(t.byteLength===0)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(o.byteOffset+o.bytesFilled!==t.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(o.bufferByteLength!==t.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(o.bytesFilled+t.byteLength>o.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");o.buffer=t.buffer,Kn(e,t.byteLength)}function Zn(e,t,o,i,u,f,c){t._controlledReadableByteStream=e,t._pullAgain=!1,t._pulling=!1,t._byobRequest=null,t._queue=t._queueTotalSize=void 0,me(t),t._closeRequested=!1,t._started=!1,t._strategyHWM=f,t._pullAlgorithm=i,t._cancelAlgorithm=u,t._autoAllocateChunkSize=c,t._pendingPullIntos=new Q,e._readableStreamController=t;let b=o();v(w(b),()=>{t._started=!0,Ee(t)},_=>{Y(t,_)})}function Ja(e,t,o){let i=Object.create(Me.prototype),u=()=>{},f=()=>w(void 0),c=()=>w(void 0);t.start!==void 0&&(u=()=>t.start(i)),t.pull!==void 0&&(f=()=>t.pull(i)),t.cancel!==void 0&&(c=_=>t.cancel(_));let b=t.autoAllocateChunkSize;if(b===0)throw new TypeError("autoAllocateChunkSize must be greater than 0");Zn(e,i,u,f,c,o,b)}function Za(e,t,o){e._associatedReadableByteStreamController=t,e._view=o}function qr(e){return new TypeError(`ReadableStreamBYOBRequest.prototype.${e} can only be used on a ReadableStreamBYOBRequest`)}function at(e){return new TypeError(`ReadableByteStreamController.prototype.${e} can only be used on a ReadableByteStreamController`)}function Xn(e){return new it(e)}function eo(e,t){e._reader._readIntoRequests.push(t)}function Xa(e,t,o){let u=e._reader._readIntoRequests.shift();o?u._closeSteps(t):u._chunkSteps(t)}function to(e){return e._reader._readIntoRequests.length}function jr(e){let t=e._reader;return!(t===void 0||!ve(t))}class it{constructor(t){if(fe(t,1,"ReadableStreamBYOBReader"),Pr(t,"First parameter"),ge(t))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!Pe(t._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");Tn(this,t),this._readIntoRequests=new Q}get closed(){return ve(this)?this._closedPromise:h(Wt("closed"))}cancel(t=void 0){return ve(this)?this._ownerReadableStream===void 0?h(De("cancel")):gr(this,t):h(Wt("cancel"))}read(t){if(!ve(this))return h(Wt("read"));if(!ArrayBuffer.isView(t))return h(new TypeError("view must be an array buffer view"));if(t.byteLength===0)return h(new TypeError("view must have non-zero byteLength"));if(t.buffer.byteLength===0)return h(new TypeError("view's buffer must have non-zero byteLength"));if(Et(t.buffer),this._ownerReadableStream===void 0)return h(De("read from"));let o,i,u=C((c,b)=>{o=c,i=b});return ro(this,t,{_chunkSteps:c=>o({value:c,done:!1}),_closeSteps:c=>o({value:c,done:!0}),_errorSteps:c=>i(c)}),u}releaseLock(){if(!ve(this))throw Wt("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");ue(this)}}}Object.defineProperties(it.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(it.prototype,n.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});function ve(e){return!d(e)||!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests")?!1:e instanceof it}function ro(e,t,o){let i=e._ownerReadableStream;i._disturbed=!0,i._state==="errored"?o._errorSteps(i._storedError):Qa(i._readableStreamController,t,o)}function Wt(e){return new TypeError(`ReadableStreamBYOBReader.prototype.${e} can only be used on a ReadableStreamBYOBReader`)}function st(e,t){let{highWaterMark:o}=e;if(o===void 0)return t;if($n(o)||o<0)throw new RangeError("Invalid highWaterMark");return o}function Ot(e){let{size:t}=e;return t||(()=>1)}function qt(e,t){le(e,t);let o=e==null?void 0:e.highWaterMark,i=e==null?void 0:e.size;return{highWaterMark:o===void 0?void 0:Tr(o),size:i===void 0?void 0:ei(i,`${t} has member 'size' that`)}}function ei(e,t){return G(e,t),o=>Tr(e(o))}function ti(e,t){le(e,t);let o=e==null?void 0:e.abort,i=e==null?void 0:e.close,u=e==null?void 0:e.start,f=e==null?void 0:e.type,c=e==null?void 0:e.write;return{abort:o===void 0?void 0:ri(o,e,`${t} has member 'abort' that`),close:i===void 0?void 0:ni(i,e,`${t} has member 'close' that`),start:u===void 0?void 0:oi(u,e,`${t} has member 'start' that`),write:c===void 0?void 0:ai(c,e,`${t} has member 'write' that`),type:f}}function ri(e,t,o){return G(e,o),i=>Te(e,t,[i])}function ni(e,t,o){return G(e,o),()=>Te(e,t,[])}function oi(e,t,o){return G(e,o),i=>se(e,t,[i])}function ai(e,t,o){return G(e,o),(i,u)=>Te(e,t,[i,u])}function no(e,t){if(!Ne(e))throw new TypeError(`${t} is not a WritableStream.`)}function ii(e){if(typeof e!="object"||e===null)return!1;try{return typeof e.aborted=="boolean"}catch{return!1}}let si=typeof AbortController=="function";function ui(){if(si)return new AbortController}class ut{constructor(t={},o={}){t===void 0?t=null:Bn(t,"First parameter");let i=qt(o,"Second parameter"),u=ti(t,"First parameter");if(ao(this),u.type!==void 0)throw new RangeError("Invalid type is specified");let c=Ot(i),b=st(i,1);Ri(this,u,b,c)}get locked(){if(!Ne(this))throw Dt("locked");return xe(this)}abort(t=void 0){return Ne(this)?xe(this)?h(new TypeError("Cannot abort a stream that already has a writer")):jt(this,t):h(Dt("abort"))}close(){return Ne(this)?xe(this)?h(new TypeError("Cannot close a stream that already has a writer")):te(this)?h(new TypeError("Cannot close an already-closing stream")):io(this):h(Dt("close"))}getWriter(){if(!Ne(this))throw Dt("getWriter");return oo(this)}}Object.defineProperties(ut.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(ut.prototype,n.toStringTag,{value:"WritableStream",configurable:!0});function oo(e){return new lt(e)}function li(e,t,o,i,u=1,f=()=>1){let c=Object.create(ut.prototype);ao(c);let b=Object.create(Ue.prototype);return ho(c,b,e,t,o,i,u,f),c}function ao(e){e._state="writable",e._storedError=void 0,e._writer=void 0,e._writableStreamController=void 0,e._writeRequests=new Q,e._inFlightWriteRequest=void 0,e._closeRequest=void 0,e._inFlightCloseRequest=void 0,e._pendingAbortRequest=void 0,e._backpressure=!1}function Ne(e){return!d(e)||!Object.prototype.hasOwnProperty.call(e,"_writableStreamController")?!1:e instanceof ut}function xe(e){return e._writer!==void 0}function jt(e,t){var o;if(e._state==="closed"||e._state==="errored")return w(void 0);e._writableStreamController._abortReason=t,(o=e._writableStreamController._abortController)===null||o===void 0||o.abort();let i=e._state;if(i==="closed"||i==="errored")return w(void 0);if(e._pendingAbortRequest!==void 0)return e._pendingAbortRequest._promise;let u=!1;i==="erroring"&&(u=!0,t=void 0);let f=C((c,b)=>{e._pendingAbortRequest={_promise:void 0,_resolve:c,_reject:b,_reason:t,_wasAlreadyErroring:u}});return e._pendingAbortRequest._promise=f,u||Fr(e,t),f}function io(e){let t=e._state;if(t==="closed"||t==="errored")return h(new TypeError(`The stream (in ${t} state) is not in the writable state and cannot be closed`));let o=C((u,f)=>{let c={_resolve:u,_reject:f};e._closeRequest=c}),i=e._writer;return i!==void 0&&e._backpressure&&t==="writable"&&Vr(i),Ci(e._writableStreamController),o}function fi(e){return C((o,i)=>{let u={_resolve:o,_reject:i};e._writeRequests.push(u)})}function zr(e,t){if(e._state==="writable"){Fr(e,t);return}Lr(e)}function Fr(e,t){let o=e._writableStreamController;e._state="erroring",e._storedError=t;let i=e._writer;i!==void 0&&uo(i,t),!pi(e)&&o._started&&Lr(e)}function Lr(e){e._state="errored",e._writableStreamController[An]();let t=e._storedError;if(e._writeRequests.forEach(u=>{u._reject(t)}),e._writeRequests=new Q,e._pendingAbortRequest===void 0){zt(e);return}let o=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,o._wasAlreadyErroring){o._reject(t),zt(e);return}let i=e._writableStreamController[vn](o._reason);v(i,()=>{o._resolve(),zt(e)},u=>{o._reject(u),zt(e)})}function ci(e){e._inFlightWriteRequest._resolve(void 0),e._inFlightWriteRequest=void 0}function di(e,t){e._inFlightWriteRequest._reject(t),e._inFlightWriteRequest=void 0,zr(e,t)}function hi(e){e._inFlightCloseRequest._resolve(void 0),e._inFlightCloseRequest=void 0,e._state==="erroring"&&(e._storedError=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._resolve(),e._pendingAbortRequest=void 0)),e._state="closed";let o=e._writer;o!==void 0&&yo(o)}function mi(e,t){e._inFlightCloseRequest._reject(t),e._inFlightCloseRequest=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._reject(t),e._pendingAbortRequest=void 0),zr(e,t)}function te(e){return!(e._closeRequest===void 0&&e._inFlightCloseRequest===void 0)}function pi(e){return!(e._inFlightWriteRequest===void 0&&e._inFlightCloseRequest===void 0)}function bi(e){e._inFlightCloseRequest=e._closeRequest,e._closeRequest=void 0}function yi(e){e._inFlightWriteRequest=e._writeRequests.shift()}function zt(e){e._closeRequest!==void 0&&(e._closeRequest._reject(e._storedError),e._closeRequest=void 0);let t=e._writer;t!==void 0&&Ur(t,e._storedError)}function Dr(e,t){let o=e._writer;o!==void 0&&t!==e._backpressure&&(t?Bi(o):Vr(o)),e._backpressure=t}class lt{constructor(t){if(fe(t,1,"WritableStreamDefaultWriter"),no(t,"First parameter"),xe(t))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=t,t._writer=this;let o=t._state;if(o==="writable")!te(t)&&t._backpressure?Mt(this):go(this),$t(this);else if(o==="erroring")Hr(this,t._storedError),$t(this);else if(o==="closed")go(this),Ai(this);else{let i=t._storedError;Hr(this,i),bo(this,i)}}get closed(){return Ae(this)?this._closedPromise:h(ke("closed"))}get desiredSize(){if(!Ae(this))throw ke("desiredSize");if(this._ownerWritableStream===void 0)throw ft("desiredSize");return wi(this)}get ready(){return Ae(this)?this._readyPromise:h(ke("ready"))}abort(t=void 0){return Ae(this)?this._ownerWritableStream===void 0?h(ft("abort")):gi(this,t):h(ke("abort"))}close(){if(!Ae(this))return h(ke("close"));let t=this._ownerWritableStream;return t===void 0?h(ft("close")):te(t)?h(new TypeError("Cannot close an already-closing stream")):so(this)}releaseLock(){if(!Ae(this))throw ke("releaseLock");this._ownerWritableStream!==void 0&&lo(this)}write(t=void 0){return Ae(this)?this._ownerWritableStream===void 0?h(ft("write to")):fo(this,t):h(ke("write"))}}Object.defineProperties(lt.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(lt.prototype,n.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});function Ae(e){return!d(e)||!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream")?!1:e instanceof lt}function gi(e,t){let o=e._ownerWritableStream;return jt(o,t)}function so(e){let t=e._ownerWritableStream;return io(t)}function _i(e){let t=e._ownerWritableStream,o=t._state;return te(t)||o==="closed"?w(void 0):o==="errored"?h(t._storedError):so(e)}function Si(e,t){e._closedPromiseState==="pending"?Ur(e,t):ki(e,t)}function uo(e,t){e._readyPromiseState==="pending"?_o(e,t):Ii(e,t)}function wi(e){let t=e._ownerWritableStream,o=t._state;return o==="errored"||o==="erroring"?null:o==="closed"?0:mo(t._writableStreamController)}function lo(e){let t=e._ownerWritableStream,o=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");uo(e,o),Si(e,o),t._writer=void 0,e._ownerWritableStream=void 0}function fo(e,t){let o=e._ownerWritableStream,i=o._writableStreamController,u=Ti(i,t);if(o!==e._ownerWritableStream)return h(ft("write to"));let f=o._state;if(f==="errored")return h(o._storedError);if(te(o)||f==="closed")return h(new TypeError("The stream is closing or closed and cannot be written to"));if(f==="erroring")return h(o._storedError);let c=fi(o);return Pi(i,t,u),c}let co={};class Ue{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!$r(this))throw xr("abortReason");return this._abortReason}get signal(){if(!$r(this))throw xr("signal");if(this._abortController===void 0)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(t=void 0){if(!$r(this))throw xr("error");this._controlledWritableStream._state==="writable"&&po(this,t)}[vn](t){let o=this._abortAlgorithm(t);return Ft(this),o}[An](){me(this)}}Object.defineProperties(Ue.prototype,{error:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(Ue.prototype,n.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});function $r(e){return!d(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledWritableStream")?!1:e instanceof Ue}function ho(e,t,o,i,u,f,c,b){t._controlledWritableStream=e,e._writableStreamController=t,t._queue=void 0,t._queueTotalSize=void 0,me(t),t._abortReason=void 0,t._abortController=ui(),t._started=!1,t._strategySizeAlgorithm=b,t._strategyHWM=c,t._writeAlgorithm=i,t._closeAlgorithm=u,t._abortAlgorithm=f;let _=Nr(t);Dr(e,_);let T=o(),I=w(T);v(I,()=>{t._started=!0,Lt(t)},k=>{t._started=!0,zr(e,k)})}function Ri(e,t,o,i){let u=Object.create(Ue.prototype),f=()=>{},c=()=>w(void 0),b=()=>w(void 0),_=()=>w(void 0);t.start!==void 0&&(f=()=>t.start(u)),t.write!==void 0&&(c=T=>t.write(T,u)),t.close!==void 0&&(b=()=>t.close()),t.abort!==void 0&&(_=T=>t.abort(T)),ho(e,u,f,c,b,_,o,i)}function Ft(e){e._writeAlgorithm=void 0,e._closeAlgorithm=void 0,e._abortAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function Ci(e){Ar(e,co,0),Lt(e)}function Ti(e,t){try{return e._strategySizeAlgorithm(t)}catch(o){return Mr(e,o),1}}function mo(e){return e._strategyHWM-e._queueTotalSize}function Pi(e,t,o){try{Ar(e,t,o)}catch(u){Mr(e,u);return}let i=e._controlledWritableStream;if(!te(i)&&i._state==="writable"){let u=Nr(e);Dr(i,u)}Lt(e)}function Lt(e){let t=e._controlledWritableStream;if(!e._started||t._inFlightWriteRequest!==void 0)return;if(t._state==="erroring"){Lr(t);return}if(e._queue.length===0)return;let i=Va(e);i===co?Ei(e):vi(e,i)}function Mr(e,t){e._controlledWritableStream._state==="writable"&&po(e,t)}function Ei(e){let t=e._controlledWritableStream;bi(t),vr(e);let o=e._closeAlgorithm();Ft(e),v(o,()=>{hi(t)},i=>{mi(t,i)})}function vi(e,t){let o=e._controlledWritableStream;yi(o);let i=e._writeAlgorithm(t);v(i,()=>{ci(o);let u=o._state;if(vr(e),!te(o)&&u==="writable"){let f=Nr(e);Dr(o,f)}Lt(e)},u=>{o._state==="writable"&&Ft(e),di(o,u)})}function Nr(e){return mo(e)<=0}function po(e,t){let o=e._controlledWritableStream;Ft(e),Fr(o,t)}function Dt(e){return new TypeError(`WritableStream.prototype.${e} can only be used on a WritableStream`)}function xr(e){return new TypeError(`WritableStreamDefaultController.prototype.${e} can only be used on a WritableStreamDefaultController`)}function ke(e){return new TypeError(`WritableStreamDefaultWriter.prototype.${e} can only be used on a WritableStreamDefaultWriter`)}function ft(e){return new TypeError("Cannot "+e+" a stream using a released writer")}function $t(e){e._closedPromise=C((t,o)=>{e._closedPromise_resolve=t,e._closedPromise_reject=o,e._closedPromiseState="pending"})}function bo(e,t){$t(e),Ur(e,t)}function Ai(e){$t(e),yo(e)}function Ur(e,t){e._closedPromise_reject!==void 0&&(ie(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected")}function ki(e,t){bo(e,t)}function yo(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved")}function Mt(e){e._readyPromise=C((t,o)=>{e._readyPromise_resolve=t,e._readyPromise_reject=o}),e._readyPromiseState="pending"}function Hr(e,t){Mt(e),_o(e,t)}function go(e){Mt(e),Vr(e)}function _o(e,t){e._readyPromise_reject!==void 0&&(ie(e._readyPromise),e._readyPromise_reject(t),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected")}function Bi(e){Mt(e)}function Ii(e,t){Hr(e,t)}function Vr(e){e._readyPromise_resolve!==void 0&&(e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled")}let So=typeof DOMException!="undefined"?DOMException:void 0;function Wi(e){if(!(typeof e=="function"||typeof e=="object"))return!1;try{return new e,!0}catch{return!1}}function Oi(){let e=function(o,i){this.message=o||"",this.name=i||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return e.prototype=Object.create(Error.prototype),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,configurable:!0}),e}let qi=Wi(So)?So:Oi();function wo(e,t,o,i,u,f){let c=$e(e),b=oo(t);e._disturbed=!0;let _=!1,T=w(void 0);return C((I,k)=>{let O;if(f!==void 0){if(O=()=>{let R=new qi("Aborted","AbortError"),E=[];i||E.push(()=>t._state==="writable"?jt(t,R):w(void 0)),u||E.push(()=>e._state==="readable"?K(e,R):w(void 0)),F(()=>Promise.all(E.map(j=>j())),!0,R)},f.aborted){O();return}f.addEventListener("abort",O)}function _e(){return C((R,E)=>{function j(J){J?R():A(pt(),j,E)}j(!1)})}function pt(){return _?w(!0):A(b._readyPromise,()=>C((R,E)=>{tt(c,{_chunkSteps:j=>{T=A(fo(b,j),void 0,a),R(!1)},_closeSteps:()=>R(!0),_errorSteps:E})}))}if(z(e,c._closedPromise,R=>{i?B(!0,R):F(()=>jt(t,R),!0,R)}),z(t,b._closedPromise,R=>{u?B(!0,R):F(()=>K(e,R),!0,R)}),re(e,c._closedPromise,()=>{o?B():F(()=>_i(b))}),te(t)||t._state==="closed"){let R=new TypeError("the destination writable stream closed before all data could be piped to it");u?B(!0,R):F(()=>K(e,R),!0,R)}ie(_e());function Se(){let R=T;return A(T,()=>R!==T?Se():void 0)}function z(R,E,j){R._state==="errored"?j(R._storedError):ee(E,j)}function re(R,E,j){R._state==="closed"?j():N(E,j)}function F(R,E,j){if(_)return;_=!0,t._state==="writable"&&!te(t)?N(Se(),J):J();function J(){v(R(),()=>W(E,j),we=>W(!0,we))}}function B(R,E){_||(_=!0,t._state==="writable"&&!te(t)?N(Se(),()=>W(R,E)):W(R,E))}function W(R,E){lo(b),ue(c),f!==void 0&&f.removeEventListener("abort",O),R?k(E):I(void 0)}})}class He{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Nt(this))throw Ht("desiredSize");return Qr(this)}close(){if(!Nt(this))throw Ht("close");if(!Ve(this))throw new TypeError("The stream is not in a state that permits close");dt(this)}enqueue(t=void 0){if(!Nt(this))throw Ht("enqueue");if(!Ve(this))throw new TypeError("The stream is not in a state that permits enqueue");return Ut(this,t)}error(t=void 0){if(!Nt(this))throw Ht("error");pe(this,t)}[wr](t){me(this);let o=this._cancelAlgorithm(t);return xt(this),o}[Rr](t){let o=this._controlledReadableStream;if(this._queue.length>0){let i=vr(this);this._closeRequested&&this._queue.length===0?(xt(this),ht(o)):ct(this),t._chunkSteps(i)}else On(o,t),ct(this)}}Object.defineProperties(He.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(He.prototype,n.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});function Nt(e){return!d(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableStream")?!1:e instanceof He}function ct(e){if(!Ro(e))return;if(e._pulling){e._pullAgain=!0;return}e._pulling=!0;let o=e._pullAlgorithm();v(o,()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,ct(e))},i=>{pe(e,i)})}function Ro(e){let t=e._controlledReadableStream;return!Ve(e)||!e._started?!1:!!(ge(t)&&Tt(t)>0||Qr(e)>0)}function xt(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function dt(e){if(!Ve(e))return;let t=e._controlledReadableStream;e._closeRequested=!0,e._queue.length===0&&(xt(e),ht(t))}function Ut(e,t){if(!Ve(e))return;let o=e._controlledReadableStream;if(ge(o)&&Tt(o)>0)Er(o,t,!1);else{let i;try{i=e._strategySizeAlgorithm(t)}catch(u){throw pe(e,u),u}try{Ar(e,t,i)}catch(u){throw pe(e,u),u}}ct(e)}function pe(e,t){let o=e._controlledReadableStream;o._state==="readable"&&(me(e),xt(e),Eo(o,t))}function Qr(e){let t=e._controlledReadableStream._state;return t==="errored"?null:t==="closed"?0:e._strategyHWM-e._queueTotalSize}function ji(e){return!Ro(e)}function Ve(e){let t=e._controlledReadableStream._state;return!e._closeRequested&&t==="readable"}function Co(e,t,o,i,u,f,c){t._controlledReadableStream=e,t._queue=void 0,t._queueTotalSize=void 0,me(t),t._started=!1,t._closeRequested=!1,t._pullAgain=!1,t._pulling=!1,t._strategySizeAlgorithm=c,t._strategyHWM=f,t._pullAlgorithm=i,t._cancelAlgorithm=u,e._readableStreamController=t;let b=o();v(w(b),()=>{t._started=!0,ct(t)},_=>{pe(t,_)})}function zi(e,t,o,i){let u=Object.create(He.prototype),f=()=>{},c=()=>w(void 0),b=()=>w(void 0);t.start!==void 0&&(f=()=>t.start(u)),t.pull!==void 0&&(c=()=>t.pull(u)),t.cancel!==void 0&&(b=_=>t.cancel(_)),Co(e,u,f,c,b,o,i)}function Ht(e){return new TypeError(`ReadableStreamDefaultController.prototype.${e} can only be used on a ReadableStreamDefaultController`)}function Fi(e,t){return Pe(e._readableStreamController)?Di(e):Li(e)}function Li(e,t){let o=$e(e),i=!1,u=!1,f=!1,c,b,_,T,I,k=C(z=>{I=z});function O(){return i||(i=!0,tt(o,{_chunkSteps:re=>{V(()=>{i=!1;let F=re,B=re;u||Ut(_._readableStreamController,F),f||Ut(T._readableStreamController,B)})},_closeSteps:()=>{i=!1,u||dt(_._readableStreamController),f||dt(T._readableStreamController),(!u||!f)&&I(void 0)},_errorSteps:()=>{i=!1}})),w(void 0)}function _e(z){if(u=!0,c=z,f){let re=rt([c,b]),F=K(e,re);I(F)}return k}function pt(z){if(f=!0,b=z,u){let re=rt([c,b]),F=K(e,re);I(F)}return k}function Se(){}return _=Gr(Se,O,_e),T=Gr(Se,O,pt),ee(o._closedPromise,z=>{pe(_._readableStreamController,z),pe(T._readableStreamController,z),(!u||!f)&&I(void 0)}),[_,T]}function Di(e){let t=$e(e),o=!1,i=!1,u=!1,f,c,b,_,T,I=C(B=>{T=B});function k(B){ee(B._closedPromise,W=>{B===t&&(Y(b._readableStreamController,W),Y(_._readableStreamController,W),(!i||!u)&&T(void 0))})}function O(){ve(t)&&(ue(t),t=$e(e),k(t)),tt(t,{_chunkSteps:W=>{V(()=>{o=!1;let R=W,E=W;if(!i&&!u)try{E=xn(W)}catch(j){Y(b._readableStreamController,j),Y(_._readableStreamController,j),T(K(e,j));return}i||kt(b._readableStreamController,R),u||kt(_._readableStreamController,E)})},_closeSteps:()=>{o=!1,i||ot(b._readableStreamController),u||ot(_._readableStreamController),b._readableStreamController._pendingPullIntos.length>0&&Bt(b._readableStreamController,0),_._readableStreamController._pendingPullIntos.length>0&&Bt(_._readableStreamController,0),(!i||!u)&&T(void 0)},_errorSteps:()=>{o=!1}})}function _e(B,W){he(t)&&(ue(t),t=Xn(e),k(t));let R=W?_:b,E=W?b:_;ro(t,B,{_chunkSteps:J=>{V(()=>{o=!1;let we=W?u:i;if(W?i:u)we||It(R._readableStreamController,J);else{let Do;try{Do=xn(J)}catch(Kr){Y(R._readableStreamController,Kr),Y(E._readableStreamController,Kr),T(K(e,Kr));return}we||It(R._readableStreamController,J),kt(E._readableStreamController,Do)}})},_closeSteps:J=>{o=!1;let we=W?u:i,er=W?i:u;we||ot(R._readableStreamController),er||ot(E._readableStreamController),J!==void 0&&(we||It(R._readableStreamController,J),!er&&E._readableStreamController._pendingPullIntos.length>0&&Bt(E._readableStreamController,0)),(!we||!er)&&T(void 0)},_errorSteps:()=>{o=!1}})}function pt(){if(o)return w(void 0);o=!0;let B=Or(b._readableStreamController);return B===null?O():_e(B._view,!1),w(void 0)}function Se(){if(o)return w(void 0);o=!0;let B=Or(_._readableStreamController);return B===null?O():_e(B._view,!0),w(void 0)}function z(B){if(i=!0,f=B,u){let W=rt([f,c]),R=K(e,W);T(R)}return I}function re(B){if(u=!0,c=B,i){let W=rt([f,c]),R=K(e,W);T(R)}return I}function F(){}return b=Po(F,pt,z),_=Po(F,Se,re),k(t),[b,_]}function $i(e,t){le(e,t);let o=e,i=o==null?void 0:o.autoAllocateChunkSize,u=o==null?void 0:o.cancel,f=o==null?void 0:o.pull,c=o==null?void 0:o.start,b=o==null?void 0:o.type;return{autoAllocateChunkSize:i===void 0?void 0:Wn(i,`${t} has member 'autoAllocateChunkSize' that`),cancel:u===void 0?void 0:Mi(u,o,`${t} has member 'cancel' that`),pull:f===void 0?void 0:Ni(f,o,`${t} has member 'pull' that`),start:c===void 0?void 0:xi(c,o,`${t} has member 'start' that`),type:b===void 0?void 0:Ui(b,`${t} has member 'type' that`)}}function Mi(e,t,o){return G(e,o),i=>Te(e,t,[i])}function Ni(e,t,o){return G(e,o),i=>Te(e,t,[i])}function xi(e,t,o){return G(e,o),i=>se(e,t,[i])}function Ui(e,t){if(e=`${e}`,e!=="bytes")throw new TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamType`);return e}function Hi(e,t){le(e,t);let o=e==null?void 0:e.mode;return{mode:o===void 0?void 0:Vi(o,`${t} has member 'mode' that`)}}function Vi(e,t){if(e=`${e}`,e!=="byob")throw new TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamReaderMode`);return e}function Qi(e,t){le(e,t);let o=e==null?void 0:e.preventCancel;return{preventCancel:Boolean(o)}}function To(e,t){le(e,t);let o=e==null?void 0:e.preventAbort,i=e==null?void 0:e.preventCancel,u=e==null?void 0:e.preventClose,f=e==null?void 0:e.signal;return f!==void 0&&Gi(f,`${t} has member 'signal' that`),{preventAbort:Boolean(o),preventCancel:Boolean(i),preventClose:Boolean(u),signal:f}}function Gi(e,t){if(!ii(e))throw new TypeError(`${t} is not an AbortSignal.`)}function Yi(e,t){le(e,t);let o=e==null?void 0:e.readable;Cr(o,"readable","ReadableWritablePair"),Pr(o,`${t} has member 'readable' that`);let i=e==null?void 0:e.writable;return Cr(i,"writable","ReadableWritablePair"),no(i,`${t} has member 'writable' that`),{readable:o,writable:i}}class be{constructor(t={},o={}){t===void 0?t=null:Bn(t,"First parameter");let i=qt(o,"Second parameter"),u=$i(t,"First parameter");if(Yr(this),u.type==="bytes"){if(i.size!==void 0)throw new RangeError("The strategy for a byte stream cannot have a size function");let f=st(i,0);Ja(this,u,f)}else{let f=Ot(i),c=st(i,1);zi(this,u,c,f)}}get locked(){if(!ye(this))throw Be("locked");return ge(this)}cancel(t=void 0){return ye(this)?ge(this)?h(new TypeError("Cannot cancel a stream that already has a reader")):K(this,t):h(Be("cancel"))}getReader(t=void 0){if(!ye(this))throw Be("getReader");return Hi(t,"First parameter").mode===void 0?$e(this):Xn(this)}pipeThrough(t,o={}){if(!ye(this))throw Be("pipeThrough");fe(t,1,"pipeThrough");let i=Yi(t,"First parameter"),u=To(o,"Second parameter");if(ge(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(xe(i.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");let f=wo(this,i.writable,u.preventClose,u.preventAbort,u.preventCancel,u.signal);return ie(f),i.readable}pipeTo(t,o={}){if(!ye(this))return h(Be("pipeTo"));if(t===void 0)return h("Parameter 1 is required in 'pipeTo'.");if(!Ne(t))return h(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let i;try{i=To(o,"Second parameter")}catch(u){return h(u)}return ge(this)?h(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):xe(t)?h(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):wo(this,t,i.preventClose,i.preventAbort,i.preventCancel,i.signal)}tee(){if(!ye(this))throw Be("tee");let t=Fi(this);return rt(t)}values(t=void 0){if(!ye(this))throw Be("values");let o=Qi(t,"First parameter");return Ua(this,o.preventCancel)}}Object.defineProperties(be.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(be.prototype,n.toStringTag,{value:"ReadableStream",configurable:!0}),typeof n.asyncIterator=="symbol"&&Object.defineProperty(be.prototype,n.asyncIterator,{value:be.prototype.values,writable:!0,configurable:!0});function Gr(e,t,o,i=1,u=()=>1){let f=Object.create(be.prototype);Yr(f);let c=Object.create(He.prototype);return Co(f,c,e,t,o,i,u),f}function Po(e,t,o){let i=Object.create(be.prototype);Yr(i);let u=Object.create(Me.prototype);return Zn(i,u,e,t,o,0,void 0),i}function Yr(e){e._state="readable",e._reader=void 0,e._storedError=void 0,e._disturbed=!1}function ye(e){return!d(e)||!Object.prototype.hasOwnProperty.call(e,"_readableStreamController")?!1:e instanceof be}function ge(e){return e._reader!==void 0}function K(e,t){if(e._disturbed=!0,e._state==="closed")return w(void 0);if(e._state==="errored")return h(e._storedError);ht(e);let o=e._reader;o!==void 0&&ve(o)&&(o._readIntoRequests.forEach(u=>{u._closeSteps(void 0)}),o._readIntoRequests=new Q);let i=e._readableStreamController[wr](t);return ae(i,a)}function ht(e){e._state="closed";let t=e._reader;t!==void 0&&(En(t),he(t)&&(t._readRequests.forEach(o=>{o._closeSteps()}),t._readRequests=new Q))}function Eo(e,t){e._state="errored",e._storedError=t;let o=e._reader;o!==void 0&&(Sr(o,t),he(o)?(o._readRequests.forEach(i=>{i._errorSteps(t)}),o._readRequests=new Q):(o._readIntoRequests.forEach(i=>{i._errorSteps(t)}),o._readIntoRequests=new Q))}function Be(e){return new TypeError(`ReadableStream.prototype.${e} can only be used on a ReadableStream`)}function vo(e,t){le(e,t);let o=e==null?void 0:e.highWaterMark;return Cr(o,"highWaterMark","QueuingStrategyInit"),{highWaterMark:Tr(o)}}let Ao=e=>e.byteLength;Object.defineProperty(Ao,"name",{value:"size",configurable:!0});class Vt{constructor(t){fe(t,1,"ByteLengthQueuingStrategy"),t=vo(t,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=t.highWaterMark}get highWaterMark(){if(!Bo(this))throw ko("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!Bo(this))throw ko("size");return Ao}}Object.defineProperties(Vt.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(Vt.prototype,n.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});function ko(e){return new TypeError(`ByteLengthQueuingStrategy.prototype.${e} can only be used on a ByteLengthQueuingStrategy`)}function Bo(e){return!d(e)||!Object.prototype.hasOwnProperty.call(e,"_byteLengthQueuingStrategyHighWaterMark")?!1:e instanceof Vt}let Io=()=>1;Object.defineProperty(Io,"name",{value:"size",configurable:!0});class Qt{constructor(t){fe(t,1,"CountQueuingStrategy"),t=vo(t,"First parameter"),this._countQueuingStrategyHighWaterMark=t.highWaterMark}get highWaterMark(){if(!Oo(this))throw Wo("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!Oo(this))throw Wo("size");return Io}}Object.defineProperties(Qt.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(Qt.prototype,n.toStringTag,{value:"CountQueuingStrategy",configurable:!0});function Wo(e){return new TypeError(`CountQueuingStrategy.prototype.${e} can only be used on a CountQueuingStrategy`)}function Oo(e){return!d(e)||!Object.prototype.hasOwnProperty.call(e,"_countQueuingStrategyHighWaterMark")?!1:e instanceof Qt}function Ki(e,t){le(e,t);let o=e==null?void 0:e.flush,i=e==null?void 0:e.readableType,u=e==null?void 0:e.start,f=e==null?void 0:e.transform,c=e==null?void 0:e.writableType;return{flush:o===void 0?void 0:Ji(o,e,`${t} has member 'flush' that`),readableType:i,start:u===void 0?void 0:Zi(u,e,`${t} has member 'start' that`),transform:f===void 0?void 0:Xi(f,e,`${t} has member 'transform' that`),writableType:c}}function Ji(e,t,o){return G(e,o),i=>Te(e,t,[i])}function Zi(e,t,o){return G(e,o),i=>se(e,t,[i])}function Xi(e,t,o){return G(e,o),(i,u)=>Te(e,t,[i,u])}class Gt{constructor(t={},o={},i={}){t===void 0&&(t=null);let u=qt(o,"Second parameter"),f=qt(i,"Third parameter"),c=Ki(t,"First parameter");if(c.readableType!==void 0)throw new RangeError("Invalid readableType specified");if(c.writableType!==void 0)throw new RangeError("Invalid writableType specified");let b=st(f,0),_=Ot(f),T=st(u,1),I=Ot(u),k,O=C(_e=>{k=_e});es(this,O,T,I,b,_),rs(this,c),c.start!==void 0?k(c.start(this._transformStreamController)):k(void 0)}get readable(){if(!qo(this))throw Lo("readable");return this._readable}get writable(){if(!qo(this))throw Lo("writable");return this._writable}}Object.defineProperties(Gt.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(Gt.prototype,n.toStringTag,{value:"TransformStream",configurable:!0});function es(e,t,o,i,u,f){function c(){return t}function b(O){return as(e,O)}function _(O){return is(e,O)}function T(){return ss(e)}e._writable=li(c,b,T,_,o,i);function I(){return us(e)}function k(O){return Kt(e,O),w(void 0)}e._readable=Gr(c,I,k,u,f),e._backpressure=void 0,e._backpressureChangePromise=void 0,e._backpressureChangePromise_resolve=void 0,Jt(e,!0),e._transformStreamController=void 0}function qo(e){return!d(e)||!Object.prototype.hasOwnProperty.call(e,"_transformStreamController")?!1:e instanceof Gt}function Yt(e,t){pe(e._readable._readableStreamController,t),Kt(e,t)}function Kt(e,t){jo(e._transformStreamController),Mr(e._writable._writableStreamController,t),e._backpressure&&Jt(e,!1)}function Jt(e,t){e._backpressureChangePromise!==void 0&&e._backpressureChangePromise_resolve(),e._backpressureChangePromise=C(o=>{e._backpressureChangePromise_resolve=o}),e._backpressure=t}class mt{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Zt(this))throw Xt("desiredSize");let t=this._controlledTransformStream._readable._readableStreamController;return Qr(t)}enqueue(t=void 0){if(!Zt(this))throw Xt("enqueue");zo(this,t)}error(t=void 0){if(!Zt(this))throw Xt("error");ns(this,t)}terminate(){if(!Zt(this))throw Xt("terminate");os(this)}}Object.defineProperties(mt.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(mt.prototype,n.toStringTag,{value:"TransformStreamDefaultController",configurable:!0});function Zt(e){return!d(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream")?!1:e instanceof mt}function ts(e,t,o,i){t._controlledTransformStream=e,e._transformStreamController=t,t._transformAlgorithm=o,t._flushAlgorithm=i}function rs(e,t){let o=Object.create(mt.prototype),i=f=>{try{return zo(o,f),w(void 0)}catch(c){return h(c)}},u=()=>w(void 0);t.transform!==void 0&&(i=f=>t.transform(f,o)),t.flush!==void 0&&(u=()=>t.flush(o)),ts(e,o,i,u)}function jo(e){e._transformAlgorithm=void 0,e._flushAlgorithm=void 0}function zo(e,t){let o=e._controlledTransformStream,i=o._readable._readableStreamController;if(!Ve(i))throw new TypeError("Readable side is not in a state that permits enqueue");try{Ut(i,t)}catch(f){throw Kt(o,f),o._readable._storedError}ji(i)!==o._backpressure&&Jt(o,!0)}function ns(e,t){Yt(e._controlledTransformStream,t)}function Fo(e,t){let o=e._transformAlgorithm(t);return ae(o,void 0,i=>{throw Yt(e._controlledTransformStream,i),i})}function os(e){let t=e._controlledTransformStream,o=t._readable._readableStreamController;dt(o);let i=new TypeError("TransformStream terminated");Kt(t,i)}function as(e,t){let o=e._transformStreamController;if(e._backpressure){let i=e._backpressureChangePromise;return ae(i,()=>{let u=e._writable;if(u._state==="erroring")throw u._storedError;return Fo(o,t)})}return Fo(o,t)}function is(e,t){return Yt(e,t),w(void 0)}function ss(e){let t=e._readable,o=e._transformStreamController,i=o._flushAlgorithm();return jo(o),ae(i,()=>{if(t._state==="errored")throw t._storedError;dt(t._readableStreamController)},u=>{throw Yt(e,u),t._storedError})}function us(e){return Jt(e,!1),e._backpressureChangePromise}function Xt(e){return new TypeError(`TransformStreamDefaultController.prototype.${e} can only be used on a TransformStreamDefaultController`)}function Lo(e){return new TypeError(`TransformStream.prototype.${e} can only be used on a TransformStream`)}r.ByteLengthQueuingStrategy=Vt,r.CountQueuingStrategy=Qt,r.ReadableByteStreamController=Me,r.ReadableStream=be,r.ReadableStreamBYOBReader=it,r.ReadableStreamBYOBRequest=nt,r.ReadableStreamDefaultController=He,r.ReadableStreamDefaultReader=et,r.TransformStream=Gt,r.TransformStreamDefaultController=mt,r.WritableStream=ut,r.WritableStreamDefaultController=Ue,r.WritableStreamDefaultWriter=lt,Object.defineProperty(r,"__esModule",{value:!0})})});var ha=bt(()=>{var Qu=65536;if(!globalThis.ReadableStream)try{Object.assign(globalThis,require("stream/web"))}catch{Object.assign(globalThis,da())}try{let{Blob:r}=require("buffer");r&&!r.prototype.stream&&(r.prototype.stream=function(a){let s=0,l=this;return new ReadableStream({type:"bytes",async pull(d){let m=await l.slice(s,Math.min(l.size,s+Qu)).arrayBuffer();s+=m.byteLength,d.enqueue(new Uint8Array(m)),s===l.size&&d.close()}})})}catch{}});var al={};ms(al,{default:()=>za});var y=require("@raycast/api"),H=require("react"),wn=ne(ta()),ja=ne(ua());var q=require("@raycast/api"),Ct=require("react");var X=require("@raycast/api");var Ba=ne(require("http"),1),Ia=ne(require("https"),1),Fe=ne(require("zlib"),1),M=ne(require("stream"),1),Wa=ne(fa(),1);var U=ne(require("stream"),1),bn=require("util");var dl=ne(ha(),1),ma=65536;async function*hn(r,n=!0){for(let a of r)if("stream"in a)yield*a.stream();else if(ArrayBuffer.isView(a))if(n){let s=a.byteOffset,l=a.byteOffset+a.byteLength;for(;s!==l;){let d=Math.min(l-s,ma),p=a.buffer.slice(s,s+d);s+=p.byteLength,yield new Uint8Array(p)}}else yield a;else{let s=0;for(;s!==a.size;){let d=await a.slice(s,Math.min(a.size,s+ma)).arrayBuffer();s+=d.byteLength,yield new Uint8Array(d)}}}var ce,St,Je,Ze,pa=(Ze=class{constructor(n=[],a={}){rr(this,ce,[]);rr(this,St,"");rr(this,Je,0);let s=0,l=n.map(p=>{let m;return ArrayBuffer.isView(p)?m=new Uint8Array(p.buffer.slice(p.byteOffset,p.byteOffset+p.byteLength)):p instanceof ArrayBuffer?m=new Uint8Array(p.slice(0)):p instanceof Ze?m=p:m=new TextEncoder().encode(p),s+=ArrayBuffer.isView(m)?m.byteLength:m.size,m}),d=a.type===void 0?"":String(a.type);Qe(this,St,/[^\u0020-\u007E]/.test(d)?"":d),Qe(this,Je,s),Qe(this,ce,l)}get size(){return Ie(this,Je)}get type(){return Ie(this,St)}async text(){let n=new TextDecoder,a="";for await(let s of hn(Ie(this,ce),!1))a+=n.decode(s,{stream:!0});return a+=n.decode(),a}async arrayBuffer(){let n=new Uint8Array(this.size),a=0;for await(let s of hn(Ie(this,ce),!1))n.set(s,a),a+=s.length;return n.buffer}stream(){let n=hn(Ie(this,ce),!0);return new ReadableStream({type:"bytes",async pull(a){let s=await n.next();s.done?a.close():a.enqueue(s.value)}})}slice(n=0,a=this.size,s=""){let{size:l}=this,d=n<0?Math.max(l+n,0):Math.min(n,l),p=a<0?Math.max(l+a,0):Math.min(a,l),m=Math.max(p-d,0),g=Ie(this,ce),S=[],P=0;for(let w of g){if(P>=m)break;let h=ArrayBuffer.isView(w)?w.byteLength:w.size;if(d&&h<=d)d-=h,p-=h;else{let A;ArrayBuffer.isView(w)?(A=w.subarray(d,Math.min(h,p)),P+=A.byteLength):(A=w.slice(d,Math.min(h,p)),P+=A.size),S.push(A),d=0}}let C=new Ze([],{type:String(s).toLowerCase()});return Qe(C,Je,m),Qe(C,ce,S),C}get[Symbol.toStringTag](){return"Blob"}static[Symbol.hasInstance](n){return n&&typeof n=="object"&&typeof n.constructor=="function"&&(typeof n.stream=="function"||typeof n.arrayBuffer=="function")&&/^(Blob|File)$/.test(n[Symbol.toStringTag])}},ce=new WeakMap,St=new WeakMap,Je=new WeakMap,Ze);Object.defineProperties(pa.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}});var Gu=pa,ba=Gu;var Re=class extends Error{constructor(n,a){super(n);Error.captureStackTrace(this,this.constructor),this.type=a}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}};var x=class extends Re{constructor(n,a,s){super(n,a);s&&(this.code=this.errno=s.code,this.erroredSysCall=s.syscall)}};var ga=require("crypto");var wt=Symbol.toStringTag,mn=r=>typeof r=="object"&&typeof r.append=="function"&&typeof r.delete=="function"&&typeof r.get=="function"&&typeof r.getAll=="function"&&typeof r.has=="function"&&typeof r.set=="function"&&typeof r.sort=="function"&&r[wt]==="URLSearchParams",oe=r=>typeof r=="object"&&typeof r.arrayBuffer=="function"&&typeof r.type=="string"&&typeof r.stream=="function"&&typeof r.constructor=="function"&&/^(Blob|File)$/.test(r[wt]);function lr(r){return typeof r=="object"&&typeof r.append=="function"&&typeof r.set=="function"&&typeof r.get=="function"&&typeof r.getAll=="function"&&typeof r.delete=="function"&&typeof r.keys=="function"&&typeof r.values=="function"&&typeof r.entries=="function"&&typeof r.constructor=="function"&&r[wt]==="FormData"}var ya=r=>typeof r=="object"&&(r[wt]==="AbortSignal"||r[wt]==="EventTarget");var Xe=`\r
`,pn="-".repeat(2),Yu=Buffer.byteLength(Xe),_a=r=>`${pn}${r}${pn}${Xe.repeat(2)}`;function Sa(r,n,a){let s="";return s+=`${pn}${r}${Xe}`,s+=`Content-Disposition: form-data; name="${n}"`,oe(a)&&(s+=`; filename="${a.name}"${Xe}`,s+=`Content-Type: ${a.type||"application/octet-stream"}`),`${s}${Xe.repeat(2)}`}var wa=()=>(0,ga.randomBytes)(8).toString("hex");async function*Ra(r,n){for(let[a,s]of r)yield Sa(n,a,s),oe(s)?yield*s.stream():yield s,yield Xe;yield _a(n)}function Ca(r,n){let a=0;for(let[s,l]of r)a+=Buffer.byteLength(Sa(n,s,l)),a+=oe(l)?l.size:Buffer.byteLength(String(l)),a+=Yu;return a+=Buffer.byteLength(_a(n)),a}var D=Symbol("Body internals"),ze=class{constructor(n,{size:a=0}={}){let s=null;n===null?n=null:mn(n)?n=Buffer.from(n.toString()):oe(n)||Buffer.isBuffer(n)||(bn.types.isAnyArrayBuffer(n)?n=Buffer.from(n):ArrayBuffer.isView(n)?n=Buffer.from(n.buffer,n.byteOffset,n.byteLength):n instanceof U.default||(lr(n)?(s=`NodeFetchFormDataBoundary${wa()}`,n=U.default.Readable.from(Ra(n,s))):n=Buffer.from(String(n)))),this[D]={body:n,boundary:s,disturbed:!1,error:null},this.size=a,n instanceof U.default&&n.on("error",l=>{let d=l instanceof Re?l:new x(`Invalid response body while trying to fetch ${this.url}: ${l.message}`,"system",l);this[D].error=d})}get body(){return this[D].body}get bodyUsed(){return this[D].disturbed}async arrayBuffer(){let{buffer:n,byteOffset:a,byteLength:s}=await fr(this);return n.slice(a,a+s)}async blob(){let n=this.headers&&this.headers.get("content-type")||this[D].body&&this[D].body.type||"",a=await this.buffer();return new ba([a],{type:n})}async json(){let n=await fr(this);return JSON.parse(n.toString())}async text(){return(await fr(this)).toString()}buffer(){return fr(this)}};Object.defineProperties(ze.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}});async function fr(r){if(r[D].disturbed)throw new TypeError(`body used already for: ${r.url}`);if(r[D].disturbed=!0,r[D].error)throw r[D].error;let{body:n}=r;if(n===null)return Buffer.alloc(0);if(oe(n)&&(n=U.default.Readable.from(n.stream())),Buffer.isBuffer(n))return n;if(!(n instanceof U.default))return Buffer.alloc(0);let a=[],s=0;try{for await(let l of n){if(r.size>0&&s+l.length>r.size){let d=new x(`content size at ${r.url} over limit: ${r.size}`,"max-size");throw n.destroy(d),d}s+=l.length,a.push(l)}}catch(l){throw l instanceof Re?l:new x(`Invalid response body while trying to fetch ${r.url}: ${l.message}`,"system",l)}if(n.readableEnded===!0||n._readableState.ended===!0)try{return a.every(l=>typeof l=="string")?Buffer.from(a.join("")):Buffer.concat(a,s)}catch(l){throw new x(`Could not create Buffer from response body for ${r.url}: ${l.message}`,"system",l)}else throw new x(`Premature close of server response while trying to fetch ${r.url}`)}var cr=(r,n)=>{let a,s,{body:l}=r;if(r.bodyUsed)throw new Error("cannot clone body after it is used");return l instanceof U.default&&typeof l.getBoundary!="function"&&(a=new U.PassThrough({highWaterMark:n}),s=new U.PassThrough({highWaterMark:n}),l.pipe(a),l.pipe(s),r[D].body=a,l=s),l},dr=(r,n)=>r===null?null:typeof r=="string"?"text/plain;charset=UTF-8":mn(r)?"application/x-www-form-urlencoded;charset=UTF-8":oe(r)?r.type||null:Buffer.isBuffer(r)||bn.types.isAnyArrayBuffer(r)||ArrayBuffer.isView(r)?null:r&&typeof r.getBoundary=="function"?`multipart/form-data;boundary=${r.getBoundary()}`:lr(r)?`multipart/form-data; boundary=${n[D].boundary}`:r instanceof U.default?null:"text/plain;charset=UTF-8",Ta=r=>{let{body:n}=r;return n===null?0:oe(n)?n.size:Buffer.isBuffer(n)?n.length:n&&typeof n.getLengthSync=="function"?n.hasKnownLength&&n.hasKnownLength()?n.getLengthSync():null:lr(n)?Ca(r[D].boundary):null},Pa=(r,{body:n})=>{n===null?r.end():oe(n)?U.default.Readable.from(n.stream()).pipe(r):Buffer.isBuffer(n)?(r.write(n),r.end()):n.pipe(r)};var yn=require("util"),Rt=ne(require("http"),1),hr=typeof Rt.default.validateHeaderName=="function"?Rt.default.validateHeaderName:r=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(r)){let n=new TypeError(`Header name must be a valid HTTP token [${r}]`);throw Object.defineProperty(n,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),n}},gn=typeof Rt.default.validateHeaderValue=="function"?Rt.default.validateHeaderValue:(r,n)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(n)){let a=new TypeError(`Invalid character in header content ["${r}"]`);throw Object.defineProperty(a,"code",{value:"ERR_INVALID_CHAR"}),a}},$=class extends URLSearchParams{constructor(n){let a=[];if(n instanceof $){let s=n.raw();for(let[l,d]of Object.entries(s))a.push(...d.map(p=>[l,p]))}else if(n!=null)if(typeof n=="object"&&!yn.types.isBoxedPrimitive(n)){let s=n[Symbol.iterator];if(s==null)a.push(...Object.entries(n));else{if(typeof s!="function")throw new TypeError("Header pairs must be iterable");a=[...n].map(l=>{if(typeof l!="object"||yn.types.isBoxedPrimitive(l))throw new TypeError("Each header pair must be an iterable object");return[...l]}).map(l=>{if(l.length!==2)throw new TypeError("Each header pair must be a name/value tuple");return[...l]})}}else throw new TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");a=a.length>0?a.map(([s,l])=>(hr(s),gn(s,String(l)),[String(s).toLowerCase(),String(l)])):void 0;super(a);return new Proxy(this,{get(s,l,d){switch(l){case"append":case"set":return(p,m)=>(hr(p),gn(p,String(m)),URLSearchParams.prototype[l].call(s,String(p).toLowerCase(),String(m)));case"delete":case"has":case"getAll":return p=>(hr(p),URLSearchParams.prototype[l].call(s,String(p).toLowerCase()));case"keys":return()=>(s.sort(),new Set(URLSearchParams.prototype.keys.call(s)).keys());default:return Reflect.get(s,l,d)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(n){let a=this.getAll(n);if(a.length===0)return null;let s=a.join(", ");return/^content-encoding$/i.test(n)&&(s=s.toLowerCase()),s}forEach(n,a=void 0){for(let s of this.keys())Reflect.apply(n,a,[this.get(s),s,this])}*values(){for(let n of this.keys())yield this.get(n)}*entries(){for(let n of this.keys())yield[n,this.get(n)]}[Symbol.iterator](){return this.entries()}raw(){return[...this.keys()].reduce((n,a)=>(n[a]=this.getAll(a),n),{})}[Symbol.for("nodejs.util.inspect.custom")](){return[...this.keys()].reduce((n,a)=>{let s=this.getAll(a);return a==="host"?n[a]=s[0]:n[a]=s.length>1?s:s[0],n},{})}};Object.defineProperties($.prototype,["get","entries","forEach","values"].reduce((r,n)=>(r[n]={enumerable:!0},r),{}));function Ea(r=[]){return new $(r.reduce((n,a,s,l)=>(s%2===0&&n.push(l.slice(s,s+2)),n),[]).filter(([n,a])=>{try{return hr(n),gn(n,String(a)),!0}catch{return!1}}))}var Ku=new Set([301,302,303,307,308]),mr=r=>Ku.has(r);var Z=Symbol("Response internals"),L=class extends ze{constructor(n=null,a={}){super(n,a);let s=a.status!=null?a.status:200,l=new $(a.headers);if(n!==null&&!l.has("Content-Type")){let d=dr(n);d&&l.append("Content-Type",d)}this[Z]={type:"default",url:a.url,status:s,statusText:a.statusText||"",headers:l,counter:a.counter,highWaterMark:a.highWaterMark}}get type(){return this[Z].type}get url(){return this[Z].url||""}get status(){return this[Z].status}get ok(){return this[Z].status>=200&&this[Z].status<300}get redirected(){return this[Z].counter>0}get statusText(){return this[Z].statusText}get headers(){return this[Z].headers}get highWaterMark(){return this[Z].highWaterMark}clone(){return new L(cr(this,this.highWaterMark),{type:this.type,url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size})}static redirect(n,a=302){if(!mr(a))throw new RangeError('Failed to execute "redirect" on "response": Invalid status code');return new L(null,{headers:{location:new URL(n).toString()},status:a})}static error(){let n=new L(null,{status:0,statusText:""});return n[Z].type="error",n}get[Symbol.toStringTag](){return"Response"}};Object.defineProperties(L.prototype,{type:{enumerable:!0},url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});var Aa=require("url");var va=r=>{if(r.search)return r.search;let n=r.href.length-1,a=r.hash||(r.href[n]==="#"?"#":"");return r.href[n-a.length]==="?"?"?":""};var de=Symbol("Request internals"),pr=r=>typeof r=="object"&&typeof r[de]=="object",Ce=class extends ze{constructor(n,a={}){let s;pr(n)?s=new URL(n.url):(s=new URL(n),n={});let l=a.method||n.method||"GET";if(l=l.toUpperCase(),(a.body!=null||pr(n))&&n.body!==null&&(l==="GET"||l==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body");let d=a.body?a.body:pr(n)&&n.body!==null?cr(n):null;super(d,{size:a.size||n.size||0});let p=new $(a.headers||n.headers||{});if(d!==null&&!p.has("Content-Type")){let g=dr(d,this);g&&p.append("Content-Type",g)}let m=pr(n)?n.signal:null;if("signal"in a&&(m=a.signal),m!=null&&!ya(m))throw new TypeError("Expected signal to be an instanceof AbortSignal or EventTarget");this[de]={method:l,redirect:a.redirect||n.redirect||"follow",headers:p,parsedURL:s,signal:m},this.follow=a.follow===void 0?n.follow===void 0?20:n.follow:a.follow,this.compress=a.compress===void 0?n.compress===void 0?!0:n.compress:a.compress,this.counter=a.counter||n.counter||0,this.agent=a.agent||n.agent,this.highWaterMark=a.highWaterMark||n.highWaterMark||16384,this.insecureHTTPParser=a.insecureHTTPParser||n.insecureHTTPParser||!1}get method(){return this[de].method}get url(){return(0,Aa.format)(this[de].parsedURL)}get headers(){return this[de].headers}get redirect(){return this[de].redirect}get signal(){return this[de].signal}clone(){return new Ce(this)}get[Symbol.toStringTag](){return"Request"}};Object.defineProperties(Ce.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}});var ka=r=>{let{parsedURL:n}=r[de],a=new $(r[de].headers);a.has("Accept")||a.set("Accept","*/*");let s=null;if(r.body===null&&/^(post|put)$/i.test(r.method)&&(s="0"),r.body!==null){let m=Ta(r);typeof m=="number"&&!Number.isNaN(m)&&(s=String(m))}s&&a.set("Content-Length",s),a.has("User-Agent")||a.set("User-Agent","node-fetch"),r.compress&&!a.has("Accept-Encoding")&&a.set("Accept-Encoding","gzip,deflate,br");let{agent:l}=r;typeof l=="function"&&(l=l(n)),!a.has("Connection")&&!l&&a.set("Connection","close");let d=va(n);return{path:n.pathname+d,pathname:n.pathname,hostname:n.hostname,protocol:n.protocol,port:n.port,hash:n.hash,search:n.search,query:n.query,href:n.href,method:r.method,headers:a[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:r.insecureHTTPParser,agent:l}};var _n=class extends Re{constructor(n,a="aborted"){super(n,a)}};var Ju=new Set(["data:","http:","https:"]);async function br(r,n){return new Promise((a,s)=>{let l=new Ce(r,n),d=ka(l);if(!Ju.has(d.protocol))throw new TypeError(`node-fetch cannot load ${r}. URL scheme "${d.protocol.replace(/:$/,"")}" is not supported.`);if(d.protocol==="data:"){let h=(0,Wa.default)(l.url),A=new L(h,{headers:{"Content-Type":h.typeFull}});a(A);return}let p=(d.protocol==="https:"?Ia.default:Ba.default).request,{signal:m}=l,g=null,S=()=>{let h=new _n("The operation was aborted.");s(h),l.body&&l.body instanceof M.default.Readable&&l.body.destroy(h),!(!g||!g.body)&&g.body.emit("error",h)};if(m&&m.aborted){S();return}let P=()=>{S(),w()},C=p(d);m&&m.addEventListener("abort",P);let w=()=>{C.abort(),m&&m.removeEventListener("abort",P)};C.on("error",h=>{s(new x(`request to ${l.url} failed, reason: ${h.message}`,"system",h)),w()}),Zu(C,h=>{g.body.destroy(h)}),process.version<"v14"&&C.on("socket",h=>{let A;h.prependListener("end",()=>{A=h._eventsCount}),h.prependListener("close",v=>{if(g&&A<h._eventsCount&&!v){let N=new Error("Premature close");N.code="ERR_STREAM_PREMATURE_CLOSE",g.body.emit("error",N)}})}),C.on("response",h=>{C.setTimeout(0);let A=Ea(h.rawHeaders);if(mr(h.statusCode)){let ie=A.get("Location"),V=ie===null?null:new URL(ie,l.url);switch(l.redirect){case"error":s(new x(`uri requested responds with a redirect, redirect mode is set to error: ${l.url}`,"no-redirect")),w();return;case"manual":V!==null&&A.set("Location",V);break;case"follow":{if(V===null)break;if(l.counter>=l.follow){s(new x(`maximum redirect reached at: ${l.url}`,"max-redirect")),w();return}let se={headers:new $(l.headers),follow:l.follow,counter:l.counter+1,agent:l.agent,compress:l.compress,method:l.method,body:l.body,signal:l.signal,size:l.size};if(h.statusCode!==303&&l.body&&n.body instanceof M.default.Readable){s(new x("Cannot follow redirect with body being a readable stream","unsupported-redirect")),w();return}(h.statusCode===303||(h.statusCode===301||h.statusCode===302)&&l.method==="POST")&&(se.method="GET",se.body=void 0,se.headers.delete("content-length")),a(br(new Ce(V,se))),w();return}default:return s(new TypeError(`Redirect option '${l.redirect}' is not a valid value of RequestRedirect`))}}m&&h.once("end",()=>{m.removeEventListener("abort",P)});let v=(0,M.pipeline)(h,new M.PassThrough,s);process.version<"v12.10"&&h.on("aborted",P);let N={url:l.url,status:h.statusCode,statusText:h.statusMessage,headers:A,size:l.size,counter:l.counter,highWaterMark:l.highWaterMark},ee=A.get("Content-Encoding");if(!l.compress||l.method==="HEAD"||ee===null||h.statusCode===204||h.statusCode===304){g=new L(v,N),a(g);return}let ae={flush:Fe.default.Z_SYNC_FLUSH,finishFlush:Fe.default.Z_SYNC_FLUSH};if(ee==="gzip"||ee==="x-gzip"){v=(0,M.pipeline)(v,Fe.default.createGunzip(ae),s),g=new L(v,N),a(g);return}if(ee==="deflate"||ee==="x-deflate"){(0,M.pipeline)(h,new M.PassThrough,s).once("data",V=>{v=(V[0]&15)===8?(0,M.pipeline)(v,Fe.default.createInflate(),s):(0,M.pipeline)(v,Fe.default.createInflateRaw(),s),g=new L(v,N),a(g)});return}if(ee==="br"){v=(0,M.pipeline)(v,Fe.default.createBrotliDecompress(),s),g=new L(v,N),a(g);return}g=new L(v,N),a(g)}),Pa(C,l)})}function Zu(r,n){let a=Buffer.from(`0\r
\r
`),s=!1,l=!1,d;r.on("response",p=>{let{headers:m}=p;s=m["transfer-encoding"]==="chunked"&&!m["content-length"]}),r.on("socket",p=>{let m=()=>{if(s&&!l){let g=new Error("Premature close");g.code="ERR_STREAM_PREMATURE_CLOSE",n(g)}};p.prependListener("close",m),r.on("abort",()=>{p.removeListener("close",m)}),p.on("data",g=>{l=Buffer.compare(g.slice(-5),a)===0,!l&&d&&(l=Buffer.compare(d.slice(-3),a.slice(0,3))===0&&Buffer.compare(g.slice(-2),a.slice(3))===0),d=g})})}var Xu="https://api.clockify.me/api/v1",Oa=r=>!r?.timeInterval?.end;async function Le(r,{method:n,body:a,headers:s,...l}={}){let d=(0,X.getPreferenceValues)(),p=String(d?.token);try{let m=await br(`${Xu}${r}`,{headers:{"X-Api-Key":p,"Content-Type":"application/json",...s},method:n||"GET",body:a?JSON.stringify(a):null,...l});return m.ok?{data:await m.json()}:(m.status===401&&((0,X.clearLocalStorage)(),(0,X.showToast)(X.ToastStyle.Failure,"Invalid API Key detected")),{error:m.statusText})}catch(m){return{error:m}}}function qa(){let r=(0,X.getPreferenceValues)();return String(r?.token).length!==48?((0,X.showToast)(X.ToastStyle.Failure,"Invalid API Key detected"),!1):!0}function el(r,n){let a=Math.abs(r.getTime()-n.getTime()),s=a%1e3;a=(a-s)/1e3;let l=a%60;a=(a-l)/60;let d=a%60;a=(a-d)/60;let p=a,m=l<=9&&l>=0?`0${l}`:l,g=d<=9&&d>=0?`0${d}`:d;return(p<=9&&p>=0?`0${p}`:p)+":"+g+":"+m}function Sn(r){return r?.timeInterval?.start?el(new Date,new Date(r.timeInterval.start)):""}function yr(){let[r,n]=(0,Ct.useState)(()=>qa()),[a,s]=(0,Ct.useState)({});return(0,Ct.useEffect)(()=>{if(!r){(0,q.clearLocalStorage)();return}async function l(){let d=await(0,q.getLocalStorageItem)("name"),p=await(0,q.getLocalStorageItem)("userId"),m=await(0,q.getLocalStorageItem)("workspaceId");if(p&&m&&d){s({userId:p,workspaceId:m,name:d});return}async function g(){(0,q.showToast)(q.ToastStyle.Animated,"Loading\u2026");let{data:S,error:P}=await Le("/user");S?((0,q.setLocalStorageItem)("userId",S.id),(0,q.setLocalStorageItem)("workspaceId",S.defaultWorkspace),(0,q.setLocalStorageItem)("name",S.name),s({userId:S.id,workspaceId:S.defaultWorkspace,name:S.name}),(0,q.showToast)(q.ToastStyle.Success,"Clockify is ready")):P==="Unauthorized"?((0,q.showToast)(q.ToastStyle.Failure,"Invalid API Key detected"),n(!1)):(0,q.showToast)(q.ToastStyle.Failure,"An error ccurred")}g()}l()},[r]),{config:a,isValidToken:r,setIsValidToken:n}}function tl(r){let[n,a]=(0,H.useState)(Sn(r));return(0,H.useEffect)(()=>{let s=setInterval(()=>a(Sn(r)),1e3);return()=>clearInterval(s)},[]),n}function rl({entry:r,updateTimeEntries:n}){let a=tl(r);return _jsx(y.List.Item,{id:r.id,title:r.project?.clientName||"No Client",subtitle:`${r.description||"No Description"}`,accessoryTitle:`${a}  -  ${r.project?.name}`,icon:{source:y.Icon.Clock,tintColor:r.project?.color},keywords:[...r.description?.split(" ")??[],...r.project?.name.split(" ")??[]],accessoryIcon:{source:y.Icon.Dot,tintColor:r.project?.color},actions:_jsx(y.ActionPanel,null,_jsx(y.ActionPanelItem,{title:"Stop Timer",onAction:()=>ol().then(()=>n())}))})}function za(){let{config:r,isValidToken:n,setIsValidToken:a}=yr(),[s,l]=(0,H.useState)([]),[d,p]=(0,H.useState)(!1),{push:m}=(0,y.useNavigation)();(0,H.useEffect)(()=>{if((0,wn.default)(r)||!n)return;async function S(){p(!0);let P=await(0,y.getLocalStorageItem)("entries");P&&l(JSON.parse(P));let C=await Rn({onError:a});C&&(l(C),(0,y.setLocalStorageItem)("entries",JSON.stringify(C))),p(!1)}S()},[r,n]);let g=(0,H.useCallback)(()=>{p(!0),Rn({onError:a}).then(S=>{S&&(l(S),(0,y.setLocalStorageItem)("entries",JSON.stringify(S))),p(!1)}).catch(()=>p(!1))},[Rn]);return _jsx(y.List,{isLoading:d,searchBarPlaceholder:"Search time entries"},n?_jsx(_jsxFragment,null,_jsx(y.List.Section,{title:"What are you working on?"},_jsx(y.List.Item,{icon:{source:y.Icon.ArrowRight},title:"Start New Timer",actions:_jsx(y.ActionPanel,null,_jsx(y.ActionPanel.Item,{title:"Start New Timer",onAction:()=>m(_jsx(nl,{updateTimeEntries:g}))}))})),_jsx(y.List.Section,{title:"Latest entries"},s.map(S=>Oa(S)?_jsx(rl,{key:S.id,entry:S,updateTimeEntries:g}):_jsx(y.List.Item,{id:S.id,key:S.id,title:S.project?.clientName||"No Client",subtitle:S.description||"No Description",accessoryTitle:S.project?.name,icon:{source:y.Icon.Circle,tintColor:S.project?.color},keywords:[...S.description?.split(" ")??[],...S.project?.name.split(" ")??[]],accessoryIcon:{source:y.Icon.Dot,tintColor:S.project?.color},actions:_jsx(y.ActionPanel,null,_jsx(y.ActionPanelItem,{title:"Start Timer",onAction:()=>{Fa(S.description,S.projectId).then(()=>g())}}))})))):_jsx(y.List.Item,{icon:y.Icon.ExclamationMark,title:"Invalid API Key Detected",accessoryTitle:"Go to Extensions \u2192 Clockify"}))}function nl({updateTimeEntries:r}){let{config:n}=yr(),[a,s]=(0,H.useState)([]),[l,d]=(0,H.useState)(!1),{pop:p}=(0,y.useNavigation)();return(0,H.useEffect)(()=>{if((0,wn.default)(n))return;async function m(){d(!0);let g=await(0,y.getLocalStorageItem)("projects");g&&s(JSON.parse(g));let{data:S}=await Le(`/workspaces/${n.workspaceId}/projects?page-size=1000`);s(S||[]),(0,y.setLocalStorageItem)("projects",JSON.stringify(S)),d(!1)}m()},[n]),_jsx(y.Form,{navigationTitle:"Add new time entry",isLoading:l,actions:_jsx(y.ActionPanel,null,_jsx(y.SubmitFormAction,{title:"Start",onSubmit:({description:m,projectId:g})=>{m&&g?(Fa(m,g).then(()=>r()),p()):(0,y.showToast)(y.ToastStyle.Failure,"All fields are required")}}),_jsx(y.ActionPanelItem,{title:"Discard",onAction:p}))},_jsx(y.Form.Dropdown,{id:"projectId",title:"Project"},a.map(m=>_jsx(y.Form.Dropdown.Item,{key:m.id,value:m.id,title:`${m.name} - ${m?.clientName||"No Client"}`,icon:{source:y.Icon.Circle,tintColor:m.color}}))),_jsx(y.Form.TextField,{id:"description",defaultValue:"",title:"Description"}))}async function Rn({onError:r}){let n=await(0,y.getLocalStorageItem)("workspaceId"),a=await(0,y.getLocalStorageItem)("userId"),{data:s,error:l}=await Le(`/workspaces/${n}/user/${a}/time-entries?hydrated=true&page-size=500`);return l==="Unauthorized"?(r&&r(!1),[]):s?.length?(0,ja.default)(s,(p,m)=>p.projectId===m.projectId&&p.description===m.description):[]}async function ol(){(0,y.showToast)(y.ToastStyle.Animated,"Stopping\u2026");let r=await(0,y.getLocalStorageItem)("workspaceId"),n=await(0,y.getLocalStorageItem)("userId"),{data:a,error:s}=await Le(`/workspaces/${r}/user/${n}/time-entries`,{method:"PATCH",body:{end:new Date().toISOString()}});!s&&a?(0,y.showToast)(y.ToastStyle.Success,"Timer stopped"):(0,y.showToast)(y.ToastStyle.Failure,"No timer running")}async function Fa(r,n){(0,y.showToast)(y.ToastStyle.Animated,"Starting\u2026");let a=await(0,y.getLocalStorageItem)("workspaceId"),{data:s}=await Le(`/workspaces/${a}/time-entries`,{method:"POST",body:{description:r,billable:!0,taskId:null,projectId:n,timeInterval:{start:new Date().toISOString(),end:null,duration:null},customFieldValues:[]}});s?.id?(0,y.showToast)(y.ToastStyle.Success,"Timer is running"):(0,y.showToast)(y.ToastStyle.Failure,"Timer could not be started")}module.exports=ps(al);0&&(module.exports={});
